(function(){var a=false,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(g){var f=this.prototype;a=true;var e=new this();a=false;for(var d in g){e[d]=typeof g[d]=="function"&&typeof f[d]=="function"&&b.test(g[d])?(function(h,i){return function(){var k=this._super;this._super=f[h];var j=i.apply(this,arguments);this._super=k;return j}})(d,g[d]):g[d]}function c(){if(!a&&this.init){this.init.apply(this,arguments)}}c.prototype=e;c.prototype.constructor=c;c.extend=arguments.callee;return c}})();var cx={};cx.Component=Class.extend({init:function(a){this.name=a;this.tag=this.name}});cx.Engine=Class.extend({init:function(){this.tag="cx.Engine";this.screen=null},update:function(){if(this.screen){this.screen.update()}},setScreen:function(a){if(this.screen){this.screen.hide()}this.screen=a;this.screen.show()}});cx.Entity=Class.extend({components:[],world:null,init:function(){this.components=[]},getWorld:function(){return this.world},setWorld:function(a){this.world=a},addComponent:function(a){this.components.push(a)},getComponent:function(b){for(var d=0,a=this.components.length;d<a;d++){var c=this.components[d];if(c.name==b){return c}}return null}});cx.Screen=Class.extend({init:function(){this.world=new cx.World()},show:function(){},hide:function(){},postUpdate:function(){},preUpdate:function(){},update:function(){this.preUpdate();this.world.update();this.postUpdate()}});cx.System=Class.extend({TYPE_VOID:"void",TYPE_PROCESS:"process",type:"process",world:null,tag:null,setWorld:function(a){this.world=a},getWorld:function(){return this.world},update:function(a,b){}});cx.EntitySystem=cx.System.extend({type:this.TYPE_PROCESS,components:null,init:function(a){this.components=a}});cx.VoidSystem=cx.System.extend({type:this.TYPE_VOID,added:function(a){}});cx.World=Class.extend({entities:[],systems:[],managers:[],tag:"cx.World",addEntity:function(a){a.index=this.entities.length;a.setWorld(this);this.entities.push(a);this._entityAdded(a)},addSystem:function(a){a.setWorld(this);this.systems.push(a)},addManager:function(a){this.managers.push(a)},getSystem:function(d){var c="";if(typeof d=="string"){c=d}else{c=d.tag}for(var b=0,a=this.systems.length;b<a;b++){var d=this.systems[b];if(d.tag==c){return d}}return null},getManager:function(b){for(var d=0,a=this.managers.length;d<a;d++){var c=this.managers[d];if(c.tag==b){return c}}return null},getEntity:function(a){return this.entities[a]},_entityValidForSystem:function(a,b){},_entityAdded:function(b){for(var c=0,a=this.systems.length;c<a;c++){var d=this.systems[c];if(d.type==d.TYPE_VOID){d.added(b)}}},update:function(){for(var p=0,j=this.systems.length;p<j;p++){var b=this.systems[p];if(b.type==b.TYPE_VOID){b.update()}else{if(b.type==b.TYPE_PROCESS){for(var i=0,f=this.entities.length;i<f;i++){var h=this.entities[i];var k=[];var l=true;for(var a=0,c=b.components.length;a<c;a++){var d=b.components[a];var n=false;for(var o=0,g=h.components.length;o<g;o++){var m=h.components[o];k[m.name]=m;if(m.name==d){n=true}}if(!n){l=false}}if(l){b.update(h,k)}}}}}}});cx.Manager=Class.extend({init:function(a){this.name=a;this.tag=this.name}});var ScriptComponent=cx.Component.extend({name:"cx.scriptcomponent",script:null,setup:false,init:function(a){this.script=a}});var ScriptSystem=cx.EntitySystem.extend({tag:"cx.scriptsystem",init:function(){this.components=["cx.scriptcomponent"]},update:function(c,d){var a=d["cx.scriptcomponent"];var b=a.script;if(a.setup==false){b.setup(c);a.setup=true}console.log("script");b.update()}});cx.Script=Class.extend({entity:null,setup:function(a){this.entity=a;this.onSetup();this.isSetUp=true},onSetup:function(){},update:function(){}});