"use strict";(function(b){var e={version:"0.9.4",initFunctions:[],addInitFunction:function(j){e.initFunctions.push(j)},init:function(){for(var k=0,j=e.initFunctions.length;k<j;k++){e.initFunctions[k]()}}};b.cx=e;console.log("Complex "+e.version);var i=function(){};i.prototype.name="cx.GameObject";i.prototype.isOneOf=function(n){var m=n.length,k=null,l=0;var j=false;for(l=0;l<m;++l){k=n[l];j=this.isA(k);if(!j){return false}}return j};i.prototype.isA=function(j){if(typeof j=="function"){return this.name==j.prototype.name}else{return this.name==j}};e.GameObject=i;var h=function(){i.call(this)};h.prototype=Object.create(i.prototype);h.prototype.constructor=h;h.prototype.name="cx.Component";e.Component=h;var f=function(j,k){if(!k){return j.createEntity()}i.call(this);this.components=null;this.componentsByName=null;this.tags=null;this.world=j;this.alive=true};f.prototype=Object.create(i.prototype);f.prototype.constructor=f;f.prototype.name="cx.Entity";f.prototype.reset=function(){this.components=[];this.componentsByName={};this.tags=[]};f.prototype.addComponent=function(j){if(Array.isArray(j)){this._addMultipleComponents(j)}else{this._addSingleComponent(j)}return this};f.prototype.addComponents=f.prototype.addComponent;f.prototype.add=f.prototype.addComponent;f.prototype._addSingleComponent=function(j){if(!(j instanceof h)){throw new Error('"component" is not of type cx.Component')}if(this.componentsByName[j.name]){throw new Error("Component of this type already exists in entity.")}this.components.push(j);this.componentsByName[j.name]=j;this.world._entityAddedComponent(this,j)};f.prototype._addMultipleComponents=function(l){var m=l.length,j=null,k=0;for(k=0;k<m;++k){j=l[k];this._addSingleComponent(j)}};f.prototype.getComponent=function(k){var j=(k.prototype?k.prototype.name:undefined)||k,k=this.componentsByName[j];return k!=undefined?k:null};f.prototype.get=f.prototype.getComponent;f.prototype.hasComponent=function(j){if(Array.isArray(j)){return this._hasMultipleComponents(j)}else{return this._hasSingleComponent(j)}};f.prototype.hasComponents=f.prototype.hasComponent;f.prototype.has=f.prototype.hasComponent;f.prototype._hasSingleComponent=function(k){var j=(k.prototype?k.prototype.name:undefined)||k;return this.componentsByName[j]?true:false};f.prototype._hasMultipleComponents=function(l){var m=l.length,j=null,k=0;for(k=0;k<m;++k){j=l[k];if(!this._hasSingleComponent(j)){return false}}return m==0?false:true};f.prototype.removeComponent=function(j){if(typeof j=="string"){this._removeByName(j)}else{if(j.prototype?j.prototype.name:undefined){this._removeByName(j.prototype.name)}else{if(Array.isArray(j)){this._removeMultiple(j)}else{this._removeByComponent(j)}}}return this};f.prototype.removeComponents=f.prototype.removeComponent;f.prototype.remove=f.prototype.remove;f.prototype._removeMultiple=function(l){var m=l.length,j=null,k=0;for(k=0;k<m;++k){j=l[k];if(typeof j=="string"){this._removeByName(j)}else{if(j.prototype?j.prototype.name:undefined){this._removeByName(j.prototype.name)}else{this._removeByComponent(j)}}}};f.prototype._removeByName=function(j){var l=this.componentsByName[j],k=this.components.indexOf(l);if(k!=-1){this.components.splice(k,1);delete this.componentsByName[j];this.world._entityRemovedComponent(this,l)}};f.prototype._removeByComponent=function(k){var j=this.components.indexOf(k);if(j!=-1){this.components.splice(j,1);delete this.componentsByName[k.name];this.world.entityRemovedComponent(this,k)}};f.prototype.destroy=function(){this.alive=false};e.Entity=f;var c=function(){i.call(this);this.world=null};c.prototype=Object.create(i.prototype);c.prototype.constructor=c;c.prototype.name="cx.System";c.prototype.addedToWorld=function(){};c.prototype.entityCreated=function(j){};c.prototype.entityDestroyed=function(j){};c.prototype.entityAddedComponent=function(j,k){};c.prototype.entityRemovedComponent=function(j,k){};c.prototype.receivedEvent=function(j,k){};c.prototype.update=function(k,j){};c.prototype.render=function(j){};e.System=c;var g=function(){c.call(this);this.components=[]};g.prototype=Object.create(c.prototype);g.prototype.constructor=g;g.prototype.name="cx.EntitySystem";g.prototype.update=function(m,k){var n=this.world.getEntitesWithComponents(this.components),l=n.length,j=0;for(j=0;j<l;++j){this.updateEntity(n[j],m,k)}};g.prototype.render=function(l){var m=this.world.getEntitesWithComponents(this.components),k=m.length,j=0;for(j=0;j<k;++j){this.renderEntity(m[j],l)}};g.prototype.entityAddedComponent=function(j,k){if(j.has(this.components)){this.entityAdded(j)}};g.prototype.entityRemovedComponent=function(j,k){if(j.has(this.components)){this.entityRemoved(j)}};g.prototype.entityAdded=function(j){};g.prototype.entityRemoved=function(j){};g.prototype.updateEntity=function(j,l,k){};g.prototype.renderEntity=function(j,k){};e.EntitySystem=g;var d=function(){e.GameObject.call(this);this.entities=[];this.systems=[];this.managers=[];this._entityPool=[];this._freeEntitiyIndicies=[]};d.prototype=Object.create(e.GameObject.prototype);d.prototype.constructor=d;d.prototype.name="cx.World";d.prototype.createEntity=function(){var j=this._entityPool.pop()||new e.Entity(this,true),k=this._freeEntitiyIndicies.pop()||this.entities.length;j.reset();this.entities[k]=j;this._entityCreated(j);return j};d.prototype.getEntitesWithComponent=function(k){var m=this.entities.length,j=null,l=0;var n=[];for(l=0;l<m;++l){j=this.entities[l];if(j.alive&&j.hasComponent(k)){n.push(j)}}return n};d.prototype.getEntitesWithComponents=d.prototype.getEntitesWithComponent;d.prototype.getEntities=function(){var m=[];for(var l=0,j=this.entities.length;l<j;l++){var k=this.entities[l];if(!k||!k.alive){continue}m.push(k)}return m};d.prototype.addSystem=function(j){j.world=this;this.systems.push(j);j.addedToWorld()};d.prototype.removeSystem=function(k){var j=this.systems.indexOf(k);if(j!=-1){this.systems.splice(j,1)}};d.prototype.addManager=function(j){j.world=this;this.managers.push(j)};d.prototype.getManager=function(k){for(var m=0,j=this.managers.length;m<j;m++){var l=this.managers[m];if(l.name==k){return this.managers[m]}}return null};d.prototype.update=function(o,m){var n=this.entities.length,j=null,k=0;for(k=0;k<n;++k){j=this.entities[k];if(!j){continue}if(!j.alive){this.entities[k]=null;this._entityPool.push(j);this._freeEntitiyIndicies.push(k);this._entityDestroyed(j)}}var p=this.systems.length,l=null;for(k=0;k<p;++k){l=this.systems[k];l.update(o,m)}};d.prototype.render=function(l){var m=this.systems.length,k=null,j=0;for(j=0;j<m;++j){k=this.systems[j];k.render(l)}};d.prototype._entityAddedComponent=function(j,k){var n=this.systems.length,m=null,l=0;for(l=0;l<n;++l){m=this.systems[l];m.entityAddedComponent(j,k)}};d.prototype._entityRemovedComponent=function(j,k){var n=this.systems.length,m=null,l=0;for(l=0;l<n;++l){m=this.systems[l];m.entityRemovedComponent(j,k)}};d.prototype._entityCreated=function(j){var m=this.systems.length,l=null,k=0;for(k=0;k<m;++k){l=this.systems[k];l.entityCreated(j)}};d.prototype._entityDestroyed=function(j){var m=this.systems.length,l=null,k=0;for(k=0;k<m;++k){l=this.systems[k];l.entityDestroyed(j)}};e.World=d;var a=function(){i.call(this);this.world=null};a.prototype=Object.create(i.prototype);a.prototype.constructor=a;a.prototype.name="cx.Manager";e.Manager=a})(this);